var smoke={smoketimeout:[],init:!1,zindex:1e3,i:0,bodyload:function(a){var b=document.createElement("div");b.setAttribute("id","smoke-out-"+a),b.className="smoke-base",b.style.zIndex=smoke.zindex,smoke.zindex++,document.body.appendChild(b)},newdialog:function(){var a=(new Date).getTime();return a=Math.random(1,99)+a,smoke.init?smoke.bodyload(a):smoke.listen(window,"load",function(){smoke.bodyload(a)}),a},forceload:function(){},build:function(a,b){smoke.i++,b.stack=smoke.i,a=a.replace(/\n/g,"<br />"),a=a.replace(/\r/g,"<br />");var h,c="",d="X",e="Cancel",f="",g="";"prompt"===b.type&&(c='<div class="dialog-prompt"><input id="dialog-input-'+b.newid+'" type="text" '+(b.params.value?'value="'+b.params.value+'"':"")+" />"+"</div>"),b.params.ok&&(d=b.params.ok),b.params.cancel&&(e=b.params.cancel),b.params.classname&&(f=b.params.classname),"signal"!==b.type&&(g='<div class="dialog-buttons">',"alert"===b.type?g+='<button id="alert-ok-'+b.newid+'">'+d+"</button>":("prompt"===b.type||"confirm"===b.type)&&(g+=b.params.reverseButtons?'<button id="'+b.type+"-ok-"+b.newid+'">'+d+"</button>"+'<button id="'+b.type+"-cancel-"+b.newid+'" class="cancel">'+e+"</button>":'<button id="'+b.type+"-cancel-"+b.newid+'" class="cancel">'+e+"</button>"+'<button id="'+b.type+"-ok-"+b.newid+'">'+d+"</button>"),g+="</div>"),h='<div id="smoke-bg-'+b.newid+'" class="smokebg"></div>'+'<div class="dialog smoke '+f+'">'+g+'<div class="dialog-inner">'+a+c+"</div>"+"</div>",smoke.init?smoke.finishbuild(a,b,h):smoke.listen(window,"load",function(){smoke.finishbuild(a,b,h)})},finishbuild:function(a,b,c){var d=document.getElementById("smoke-out-"+b.newid);for(d.className="smoke-base smoke-visible  smoke-"+b.type,d.innerHTML=c;""===d.innerHTML;)d.innerHTML=c;switch(smoke.smoketimeout[b.newid]&&clearTimeout(smoke.smoketimeout[b.newid]),smoke.listen(document.getElementById("smoke-bg-"+b.newid),"click",function(){smoke.destroy(b.type,b.newid),"prompt"===b.type||"confirm"===b.type?b.callback(!1):"alert"===b.type&&b.callback!==void 0&&b.callback()}),b.type){case"alert":smoke.finishbuildAlert(a,b,c);break;case"confirm":smoke.finishbuildConfirm(a,b,c);break;case"prompt":smoke.finishbuildPrompt(a,b,c);break;case"signal":smoke.finishbuildSignal(a,b,c);break;default:throw"Unknown type: "+b.type}},finishbuildAlert:function(a,b){smoke.listen(document.getElementById("alert-ok-"+b.newid),"click",function(){smoke.destroy(b.type,b.newid),b.callback!==void 0&&b.callback()}),document.onkeyup=function(a){a||(a=window.event),(13===a.keyCode||32===a.keyCode||27===a.keyCode)&&(smoke.destroy(b.type,b.newid),b.callback!==void 0&&b.callback())}},finishbuildConfirm:function(a,b){smoke.listen(document.getElementById("confirm-cancel-"+b.newid),"click",function(){smoke.destroy(b.type,b.newid),b.callback(!1)}),smoke.listen(document.getElementById("confirm-ok-"+b.newid),"click",function(){smoke.destroy(b.type,b.newid),b.callback(!0)}),document.onkeyup=function(a){a||(a=window.event),13===a.keyCode||32===a.keyCode?(smoke.destroy(b.type,b.newid),b.callback(!0)):27===a.keyCode&&(smoke.destroy(b.type,b.newid),b.callback(!1))}},finishbuildPrompt:function(a,b){var d=document.getElementById("dialog-input-"+b.newid);setTimeout(function(){d.focus(),d.select()},100),smoke.listen(document.getElementById("prompt-cancel-"+b.newid),"click",function(){smoke.destroy(b.type,b.newid),b.callback(!1)}),smoke.listen(document.getElementById("prompt-ok-"+b.newid),"click",function(){smoke.destroy(b.type,b.newid),b.callback(d.value)}),document.onkeyup=function(a){a||(a=window.event),13===a.keyCode?(smoke.destroy(b.type,b.newid),b.callback(d.value)):27===a.keyCode&&(smoke.destroy(b.type,b.newid),b.callback(!1))}},finishbuildSignal:function(a,b){smoke.smoketimeout[b.newid]=setTimeout(function(){smoke.destroy(b.type,b.newid)},b.timeout)},destroy:function(a,b){var c=document.getElementById("smoke-out-"+b),d=document.getElementById(a+"-ok-"+b),e=document.getElementById(a+"-cancel-"+b);c.className="smoke-base",d&&(smoke.stoplistening(d,"click",function(){}),document.onkeyup=null),e&&smoke.stoplistening(e,"click",function(){}),smoke.i=0,c.innerHTML=""},alert:function(a,b,c){"object"!=typeof b&&(b=!1);var d=smoke.newdialog();smoke.build(a,{type:"alert",callback:c,params:b,newid:d})},signal:function(a,b){b===void 0&&(b=5e3);var c=smoke.newdialog();smoke.build(a,{type:"signal",timeout:b,params:!1,newid:c})},confirm:function(a,b,c){"object"!=typeof c&&(c=!1);var d=smoke.newdialog();smoke.build(a,{type:"confirm",callback:b,params:c,newid:d})},prompt:function(a,b,c){"object"!=typeof c&&(c=!1);var d=smoke.newdialog();return smoke.build(a,{type:"prompt",callback:b,params:c,newid:d})},listen:function(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):!1},stoplistening:function(a,b,c){return a.removeEventListener?a.removeEventListener("click",c,!1):a.detachEvent?a.detachEvent("on"+b,c):!1}};smoke.init||smoke.listen(window,"load",function(){smoke.init=!0});